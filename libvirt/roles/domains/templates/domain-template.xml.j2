{# ./roles/domains/templates/domain-template.xml.j2 #}
{#  creates only the most basic domain, all devices will be "attached" later on #}
<domain type='kvm'>
    <name>{{ item.name }}</name>
    <memory unit='MiB'>{{ item.memory | default(default_domain.memory) }}</memory>
    <vcpu>{{ item.cpu | default(default_domain.cpu) }}</vcpu>
    <os firmware="efi">
        <type arch="x86_64" machine="pc-q35-9.1">hvm</type>
        <firmware>
            <feature enabled="no" name="enrolled-keys"/>
            <feature enabled="yes" name="secure-boot"/>
        </firmware>
        <loader readonly="yes" secure="yes" type="pflash">/usr/share/edk2/x64/OVMF_CODE.secboot.4m.fd</loader>
 </os>
    <features>
        <acpi/>
        <apic/>
    </features>
    <cpu mode='host-model'/>
    <devices>
        <graphics type="spice" autoport="yes">
            <listen type="address"/>
            <image compression="off"/>
            <gl enable="no"/>
        </graphics>
        <video>
            <model type="cirrus" vram="16384" heads="1" primary="yes"/>
            <address type="pci" domain="0x0000" bus="0x07" slot="0x01" function="0x0"/>
        </video>
    </devices>
</domain>